
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>cd ~/jaequery</title>
	<meta name="author" content="jaequery">

	
	<meta name="description" content="In the pursuit of achieving the perfect web development environment on Mac, I&#8217;d need two things. LAMP environment
Ruby/Rails environment For &hellip;">
	

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

	<link href="/atom.xml" rel="alternate" title="cd ~/jaequery" type="application/atom+xml">
	
	<link rel="canonical" href="http://jaequery.github.com/">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	<link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,400,700' rel='stylesheet' type='text/css'>
	<!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

	
	<script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-38367647-1']);
		_gaq.push(['_trackPageview']);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	</script>


</head>

<body>
	<div class="container">
		<div class="left-col">
			<div class="intrude-less">
			<header id="header" class="inner"><div class="profilepic">	
	<img src="https://twimg0-a.akamaihd.net/profile_images/1553518100/276361_588421810_1000318656_n.jpg" alt="Profile Picture" style="width: 160px;">
</div>
<h1><a href="/">cd ~/jaequery</a></h1>
<p class="subtitle">Work hard. Aim high. Stay humble. <br>CTO at <a href="http://www.processing.com" target="_blank">processing.com</a></p>
<nav id="main-nav"><ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/about">About</a></li>
  <li><a href="/projects">Projects</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>
</nav>
<nav id="sub-nav">
	<div class="social">
		
		
		
		<a class="twitter" href="http://twitter.com/jaequery" title="Twitter">Twitter</a>
		
		
		<a class="github" href="https://github.com/jaequery" title="GitHub">GitHub</a>
		
		
		
		
		
		
		<a class="rss" href="/atom.xml" title="RSS">RSS</a>
		
	</div>
</nav>


</header>				
			</div>
		</div>	
		<div class="mid-col">
			
				
<div id="banner" class="inner">
	<div class="container">
		<ul class="feed"></ul>
	</div>
	<small><a href="http://twitter.com/jaequery">jaequery</a> @ <a href="http://twitter.com">Twitter</a></small>
	<div class="loading">Loading...</div>
</div>
<script src="/javascripts/twitter.js"></script>
<script type="text/javascript">
	(function($){
		$('#banner').getTwitterFeed('jaequery', 4, false);
	})(jQuery);
</script>

			
			<div class="mid-col-container">
				<div id="content" class="inner">


    <article class="post">
	<div class="meta">
		<div class="date">








  


<time datetime="2013-03-12T15:28:00-07:00" pubdate data-updated="true">Mar 12<span>th</span>, 2013</time></div>
		<div class="tags">

</div>
		
	</div>
	<h1 class="title"><a href="/blog/2013/03/12/running-pow-and-mamp-simultaneously/">Running Pow and MAMP Simultaneously</a></h1>
	<div class="entry-content">
		<p>In the pursuit of achieving the perfect web development environment on Mac, I&#8217;d need two things.</p>

<ol>
<li>LAMP environment</li>
<li>Ruby/Rails environment</li>
</ol>


<p>For LAMP, I&#8217;ve settled on MAMP Pro. Although it costs a bit of money, this is by far the best way to manage your sites locally. For one, it&#8217;s got a great GUI to manage your vhosts. Editing by hand can get tedious and this takes care of it. It even adds /etc/hosts entries for you to handle local name resolutions.</p>

<p>For Ruby, Pow has been an unbelievably efficient way of running and managing multiple ruby apps for me. All you have to do is just drop a folder in your ~/.pow and you are set as it also handles local name resolutions for you on the fly.</p>

<p>But getting both of them to work at the same time posed a problem but a quick SO search revealed a very cool trick:</p>

<p><a href="http://stackoverflow.com/questions/7010104/running-pow-mamp-pro-simultaneously">Setting up Pow and MAMP to work simultaneiously</a></p>

		
		
	</div>

</article>


    <article class="post">
	<div class="meta">
		<div class="date">








  


<time datetime="2013-02-09T00:10:00-08:00" pubdate data-updated="true">Feb 9<span>th</span>, 2013</time></div>
		<div class="tags">


	<a class='category' href='/blog/categories/macs/'>macs</a>


</div>
		
	</div>
	<h1 class="title"><a href="/blog/2013/02/09/a-month-after-switching-to-macs/">A Month After Switching to Macs</a></h1>
	<div class="entry-content">
		<h3>The story</h3>

<p>For most of my life, I had a deep resentment toward Macs. I always never liked their concept of trying to do something different. Back in the days, my feelings all started with their philosophy of one-button mouse. I appreciate they want to keep it simple but as a computer, it just didn&#8217;t make sense to me. I grew up with things that had a lot of buttons, my favorite video games all had atleast 6 buttons to press. Heck, if they had 3 buttons when PCs had 2, I&#8217;d have given them a second look. But no, Macs were consistently pushing one-button, even to this date.</p>

<p>Anyhow, I&#8217;ve grown accustomed to PCs very much. I know almost all the keyboard shortcuts Windows has to offer, allowing me to do virtually anything instantly and seamlessly at ease. Simply put, I was quite happy and comfortable with it so switching to anything else would throw me off guard and would not be my ideal situation.</p>

<h3>Tried Macs (several times)</h3>

<p>But because I also enjoy trying out new and shiny things, time and time I&#8217;d buy a Mac, try it out, and find myself totally weirded out by it. Sometimes, I tried so hard to like it, but I just was not quite as productive on a Mac than on a PC. If it wasn&#8217;t a gift from my wife, I would&#8217;ve returned it for a full refund. Anyway, it was just collecting dust. I just had too much work to do and I absolutely require productivity.</p>

<h3>My PC broke hardcore</h3>

<p>Then one day, my awesome PC just died. It was a Lenovo Thinkpad and it was just the perfect fit for me, small, compact, and dock-station ready. I&#8217;d take it wherever I go, work, home, friends, it was one thing I&#8217;d never leave my house without. Had some great memories with it and some bad. I was just overly distraught, like losing a kitten or something.</p>

<h3>Powering on the dusty old Mac</h3>

<p>Since I had no other choice, I powered up my Macbook Air for me to continue working. The utter feeling of being slow and un-productive was catching up to me really fast. At this point, I already knew a most of the common keyboard shortcut commands, such as spotlight, alt-tab, cmd+shift+[ and ], and so on. But it just wasn&#8217;t the same. It sucked.</p>

<p>As I was on a strict deadline at work, I decided I&#8217;ll just have to use Mac for now and deal with PC later. I knew I had to get up to speed fast as I absolutely must be <em>productive</em>. Now at this time, I decided to try to understand what made me less productive on a Mac compared to PC.</p>

<p>So here are what I just didn&#8217;t like about Macs:</p>

<ol>
<li>No easy way to maximize window and full screen mode weirded me out. On Windows, I&#8217;d just double click on the window title. But on Macs, I had to carefully hit the green plus button.</li>
<li>Sometimes, my window would get minimized and when I cmd+tab back into it, I don&#8217;t see anything. I read article that I had to also hold options and release before I get to it, which was probably the dumbest thing I have ever heard.</li>
<li>There was no Start+e equivalent to open explorer/finder. On Windows, I&#8217;d just start+e and just start typing to get to any folders/files on my PC. On Mac, closest I&#8217;ve come across was to just locate finder from cmd+tab, or launch finder via an app called Alfred.</li>
<li>No Zend Studio 5.5. This was almost a deal breaker right on the spot.</li>
<li>Mac keyboards aren&#8217;t too friendly for emacs user. Hitting that option button for meta is quite an excercise in itself.</li>
</ol>


<p>Since I just could not live without these, I looked hard online to see if there was anything remotely even close to how it was on PCs. And I can now safely say, I did, and boy am I glad I took that extra time to do so, as it has paid off in dividends.</p>

<ol>
<li><p>To perform maximize window, I had to go to System Preferences -> Keyboard -> Keyboard Shortcuts -> Add, and put in &#8220;Zoom&#8221;, and shortcut as &#8220;cmd+shift+m&#8221;. Now this will trigger the green maximize button an any active window I&#8217;m on which is incredibly useful for me as I hate any apps/windows that floats around in a &#8220;limbo&#8221; state.</p></li>
<li><p>Now I knew there was no other way, I looked hard and there just was no supported option for having cmd+tab to work the way it did on PCs. Then fortunately I stumbled across a forum which discussed exactly same problem I was having and one person mentioned that I should install an app called: <a href="http://manytricks.com/witch/">Witch</a>. It wasn&#8217;t free, I had just installed their trial and I was reasonably satisfied with it, as now when I switch back to any app, it&#8217;d even restore it from minimized state. Only issue I have is that it&#8217;s not as responsive as native cmd+tab, there is a slight delay.</p></li>
<li><p>I searched hard and found another gold mine, cmd+option+space. It opened finder just as I used to open Explorer. One caveat, sometimes it would open it without any side panels (main folders on the left), but quickly found out that you can hit cmd+option+t to toggle the sidepanel.</p></li>
<li><p>Now this was tough, I been using ZS 5.5 for roughly close to 8+ years. It was my bread and butter when it comes to development. I had a lot of shortcut/macros to do whatever I needed and all of that was now taken away from me. But since I had no choice, I went on an IDE download spree, testing just about all the IDE&#8217;s out there available for mac, including: Coda, Textmate, Sublime, Eclipse, etc &#8230; And after a good couple hair pulling days, I managed to find something I liked, and that happened to be Aptana Studios. In fact, I found this to surpass even Zend Studio in many ways. The auto code formatting via cmd+shift+f to be awesome. And on top of it all, it was the only IDE that provided the closest to emacs as one can possibly get. My only gripe is, ctrl+s works for search but ctrl+r (reverse search) doesn&#8217;t. Quite baffling to me and I hope I can find out how to get around to doing it.</p></li>
<li><p>In the beginning, I was mostly upset about how it is now too difficult for me to hit the meta key. It&#8217;s almost as if I have to stretch my left thumb all the way out to where my pinky is. If you are an emacs user, you probably understand just how important it is to hit that meta key repeatedly :) But miraculously, I learned to get accustomed to it. I guess human mind really allow you to get accustomed to anything if no other given choices exists.</p></li>
</ol>


<h3>I love Macs now</h3>

<p>After taking some several weeks of changing my habits and learning some new tricks, I am now quite fond of Macs. I never really thought I will be saying this but Macs are indeed superior to PCs in just about every way. For those that wants to know why:</p>

<ol>
<li><p>Mac&#8217;s apps are just so much better and nicer. For one, Textual was a huge improvement over mIRC, mainly in the aesthetics department. Querious (db gui) is simple and elegant and suits my needs just fine. And even Mac&#8217;s native apps, such as: iCal, iPhotos, and Mail just trumps anything PCs have to offer. It&#8217;s almost no contest who wins here.</p></li>
<li><p>Bash being integrated to the OS is a life changer. As I&#8217;m big on linux, this itself was a huge improvement over PCs. I can now finally sleep happy and not worry about the days of putty&#8217;ing.</p></li>
<li><p>TimeMachine is too good. Backups couldn&#8217;t get any simpler, point-in-time restore of any files back in time is just lovely.</p></li>
<li><p>I now fully appreciate the entire Mac keyboard shortcut eco-system. Easy to customize and not buggy like on Windows.</p></li>
<li><p>Not having to rely on Virtualbox/Vmware to launch local servers. I find brew surprisingly refreshing to use and setting up a LAMP, or RoR, or even django is extremely easy to setup on Mac.</p></li>
</ol>


<h3>One big caveat about Macbook Air</h3>

<p>If you are like me, you enjoy taking your laptop everywhere you go. And when you get to an office, you&#8217;d like to hook it up to dual-screen monitors. Surely I thought this would be a walk in the park, as with any other PC&#8217;s. But no, it turned out to be quite an ordeal. Basically the problem is, in order to extend your monitor, you need to hook them from your mini displayport to the monitor. But Macbook airs only have a single mini-displayport and from my research, there aren&#8217;t any mini-dp hubs as you&#8217;d have with usbs (i know some exists but they sell for $300+).</p>

<p>It turns out, there is an alternative, which is what they call a DisplayLink USB to DVI adapter.</p>

<p>You need to buy a few things:</p>

<ul>
<li>Mini-dp to DVI (or vga)</li>
<li>USB to DVI (or vga)</li>
</ul>


<p>I bought them from Amazon:</p>

<ul>
<li><a href="http://www.amazon.com/gp/product/B00425MQGA/">J-Tech Digital High Quality Mini DisplayPort to DVI Adapter female Cable</a> for $12.99</li>
<li><a href="http://www.amazon.com/gp/product/B0038P1TP4/">Plugable UGA-2K-A USB 2.0 to VGA/DVI/HDMI Adapter</a> for $59.95</li>
</ul>


<p>I was quite shocked at the price of that USB adapter but then again, it&#8217;s worth buying for that extra monitor. I&#8217;d have to warn though that there is a slight lag on the monitor this hooks up with as USB is not as fast as mini-displayport. But for just normal activity including browsing/email/coding, I haven&#8217;t been too bothered by it.</p>

<h3>App recommendations</h3>

<p>Here are few that I have and can&#8217;t live without:</p>

<ul>
<li><a href="http://flexibits.com/fantastical">fantastical, a calendar app, gives you a nice quick hotkey to add tasks/events</a></li>
<li><a href="http://code.google.com/p/tunnelblick">Tunnelblick, OpenVPN client</a></li>
<li><a href="http://getcloudapp.com/">getcloudapp, uploads copy buffers to the web and returns you a shortened link, useful for screen captures</a></li>
<li><a href="http://www.omnigroup.com/products/omnigraffle/">omnigraffle, sweet flowchart/diagram creator</a></li>
<li><a href="http://gitx.frim.nl/">gitx, nice little git gui client which can even be invoked from command line on working directory</a></li>
<li><a href="http://www.codeux.com/textual/">textual, a near perfect irc client</a></li>
<li><a href="http://www.araelium.com/querious/">querious, nice little sql gui client</a></li>
<li><a href="http://www.aptana.com/">aptana studio, imo the best IDE in the market</a></li>
<li><a href="http://www.apple.com/aperture/">aperture, great photo viewer</a></li>
</ul>


<p>If you know of any other apps that I should try, feel free to let me know at @jaequery. I&#8217;m all ears.</p>

		
		
	</div>

</article>


    <article class="post">
	<div class="meta">
		<div class="date">








  


<time datetime="2013-02-08T11:16:00-08:00" pubdate data-updated="true">Feb 8<span>th</span>, 2013</time></div>
		<div class="tags">


	<a class='category' href='/blog/categories/rails/'>rails</a>


</div>
		
	</div>
	<h1 class="title"><a href="/blog/2013/02/08/pagination-in-ruby-on-rails/">Pagination in Ruby on Rails</a></h1>
	<div class="entry-content">
		<p>I haven&#8217;t tried it out yet but it looks like Rails uses a gem called &#8220;kaminari&#8221; for dealing with pagination.
Here is a nice video tutorial on usage at <a href="http://railscasts.com/episodes/254-pagination-with-kaminari">Railscast</a></p>

<p>Basically it involves doing:</p>

<ul>
<li>Bash</li>
</ul>


<p><code>
bundle
rails g kaminari:views default
</code></p>

<ul>
<li>update Gemfile to include the kaminari gem</li>
</ul>


<p><code>
gem 'kaminari'
</code></p>

<ul>
<li>update controller (products_controller.rb)</li>
</ul>


<p><code>
@products = Product.order("name").page(params[:page]).per(5)
</code></p>

<ul>
<li>update locales (config/locales/en.yml)</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>en:
</span><span class='line'>  hello: "Hello world"
</span><span class='line'>  views:
</span><span class='line'>    pagination:
</span><span class='line'>      previous: "&lt; Previous"
</span><span class='line'>      next: "Next &gt;"
</span><span class='line'>      truncate: "..."</span></code></pre></td></tr></table></div></figure>


<ul>
<li>print pagination from view (products/index.html.erb)</li>
</ul>


<p><code>
&lt;%= paginate @products %&gt;
</code></p>

		
		
	</div>

</article>


    <article class="post">
	<div class="meta">
		<div class="date">








  


<time datetime="2013-02-05T22:55:00-08:00" pubdate data-updated="true">Feb 5<span>th</span>, 2013</time></div>
		<div class="tags">


	<a class='category' href='/blog/categories/security/'>security</a>


</div>
		
	</div>
	<h1 class="title"><a href="/blog/2013/02/05/quick-secure-iptables-ruleset/">A Strong Iptables Ruleset for Running Websites</a></h1>
	<div class="entry-content">
		<p>Here is a simple quick rule to get you secure for most running websites. But it is extremely strict as it only allows HTTP (port 80) from the internet.</p>

<p>Save this into a file (e.g; ~/iptables.hardened)</p>

<pre><code>*filter
:INPUT ACCEPT [0:0]
:FORWARD DROP [0:0]
:OUTPUT ACCEPT [0:0]
-A INPUT -i lo -j ACCEPT
-A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT
-A INPUT -m state --state INVALID -j DROP
-A INPUT -p icmp -m icmp --icmp-type any -j ACCEPT
-A INPUT -p tcp --dport 80 -j ACCEPT
-A INPUT -p tcp -s x.x.x.x/32 --dport 22 -j ACCEPT
-A INPUT -p tcp -s x.x.x.x/32 --dport 3306 -j ACCEPT
-A INPUT -p tcp --dport 0:1024 -m state --state NEW -m limit --limit 5/s -j LOG
-A INPUT -j DROP
COMMIT
</code></pre>

<p>Then test it by:</p>

<pre><code> iptables-restore &lt; ~/iptables.hardened
</code></pre>

<p>Note) If you are paranoid and don&#8217;t want to risk yourself from locking out of the machine, just make sure to add a cronjob to stop iptables every minute.
Something like:
<code>*/5 * * * * /etc/init.d/iptables stop</code></p>

<p>Once you are satisfied, save it to your /etc/sysconfig/iptables to make it permanent.</p>

		
		
	</div>

</article>


    <article class="post">
	<div class="meta">
		<div class="date">








  


<time datetime="2013-02-04T11:53:00-08:00" pubdate data-updated="true">Feb 4<span>th</span>, 2013</time></div>
		<div class="tags">


	<a class='category' href='/blog/categories/emacs/'>emacs</a>, <a class='category' href='/blog/categories/ide-/'>ide,</a>


</div>
		
	</div>
	<h1 class="title"><a href="/blog/2013/02/04/ultimate-emacs-elisp-for-web-development/">Ultimate Emacs Elisp for Web Development</a></h1>
	<div class="entry-content">
		<p>Emacs out of the box doesn’t have a great php/html/js editor. So here are what you need to get it good.</p>

<ul>
<li>First, let’s create the elisp folder that stores all your elisps:</li>
</ul>


<p><code>mkdir ~/elisp &amp;&amp; cd ~/elsip</code></p>

<ul>
<li>Now download “php-mode”</li>
</ul>


<p><code>wget http://php-mode.svn.sourceforge.net/svnroot/php-mode/tags/php-mode-1.5.0/php-mode.el</code></p>

<ul>
<li>Now download “multi-web-mode” for html/js/css</li>
</ul>


<p><code>wget https://raw.github.com/fgallina/multi-web-mode/master/multi-web-mode.el</code></p>

<ul>
<li>Now add/update this line to your ~/.emacs file</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>(add-to-list ‘load-path “~/elisp”)
</span><span class='line'>(require ‘php-mode)
</span><span class='line'>(require ‘multi-web-mode)
</span><span class='line'>(setq mweb-default-major-mode ‘html-mode)
</span><span class='line'>(setq mweb-tags ‘((php-mode “&lt;\?php\|&lt;\? \|&lt;\?=” “\?&gt;”)
</span><span class='line'>(js-mode “”)
</span><span class='line'>(css-mode “”)))
</span><span class='line'>(setq mweb-filename-extensions ‘(“php” “htm” “html” “ctp” “phtml” “php4” “php5”))
</span><span class='line'>(multi-web-global-mode 1)</span></code></pre></td></tr></table></div></figure>


		
		
	</div>

</article>


    <article class="post">
	<div class="meta">
		<div class="date">








  


<time datetime="2013-02-03T19:08:00-08:00" pubdate data-updated="true">Feb 3<span>rd</span>, 2013</time></div>
		<div class="tags">


	<a class='category' href='/blog/categories/rails/'>rails</a>, <a class='category' href='/blog/categories/ruby-/'>ruby,</a>


</div>
		
	</div>
	<h1 class="title"><a href="/blog/2013/02/03/ruby-is-strange-and-odd/">Ruby Is Strange and Odd</a></h1>
	<div class="entry-content">
		<h3>Day 2 of Ruby</h3>

<p>It&#8217;s strange and I am confused by all these weird syntaxes.</p>

<p>Coming from PHP, I assumed at first glance:</p>

<pre><code>   @name (ruby) is $name (php)
</code></pre>

<p>But no, because in ruby, you have several different ways of assigning a variable.</p>

<p>There are:</p>

<ul>
<li>@name (instance var)</li>
<li>@@name (class var)</li>
<li>name (method var)</li>
</ul>


<p>Not to mention, &#8220;symbols&#8221; which really threw me off guard.</p>

<p>Anyhow, here is what I found out.</p>

<ol>
<li><p>@name (instance var)
Instance vars are similar to $this->name in php.
So @name = $this->name.</p></li>
<li><p>@@name (class var)
Now this one is a bit tricky. Class vars probably won&#8217;t ring a bell to PHP developer as in PHP, class vars are like instance vars. However in Ruby, @@name is similar to static vars.
The reason why it&#8217;s that is because if you have 3-4+ instances of a class, @@name is shared by all of them. Somewhat of a singleton variable.</p></li>
<li><p>name (method var)
This is pretty straight forward. It&#8217;s a var that only lives inside a method. Good for throwaway/temporary variables, such as res, total, etc &#8230;</p></li>
<li><p>:name (symbols)
Before learning ruby, I thought this was ruby&#8217;s way of PHP&#8217;s $ sign. Every ruby code I see online had some :symbols and I thought ruby would be a walk in the park as long as I think to myself that is PHP&#8217;s equivalent of assigning variables. But no, it&#8217;s probably what threw me off the most.</p></li>
</ol>


<p>You see, :symbols aren&#8217;t something you can assign to. It&#8217;s not a variable, it&#8217;s a reference. Or, atleast that&#8217;s what other ruby devs told me on freenode. I still didn&#8217;t undersetand, so is this like a pointer reference I asked? And they said no. After about an hour of chatting back and forth, I came to conclusion from bits and pieces of evidence that :symbols are only used inside hashes as keys.</p>

<p>So in php land:</p>

<pre><code>$users = array(
    "name" =&gt; "john",
    "name" =&gt; "mark",
)

foreach($users AS $user){
    echo $user['name'];
}
</code></pre>

<p>But in ruby land, it&#8217;s:</p>

<pre><code>users = {
    :name =&gt; "john",
    :name =&gt; "mark",
}

users.each do |user|
    puts user.name
end
</code></pre>

		
		
	</div>

</article>


    <article class="post">
	<div class="meta">
		<div class="date">








  


<time datetime="2013-02-01T19:07:00-08:00" pubdate data-updated="true">Feb 1<span>st</span>, 2013</time></div>
		<div class="tags">

</div>
		
	</div>
	<h1 class="title"><a href="/blog/2013/02/01/switching-from-php-to-ror/">Switching From PHP to RoR</a></h1>
	<div class="entry-content">
		<p>In one unlikely evening, I was bored and just felt like doing something new, I did something I probably never thought I&#8217;d do. Jump into RoR.
I say unlikely because those that knows me, knows how much of a PHP advocate I am. Afterall, I didn&#8217;t spend 10+ years on it for nothing.
I&#8217;m also not the type to stop on something until I&#8217;ve mastered it. I suddenly now have quite a challenge on my hands.</p>

		
		
	</div>

</article>


    <article class="post">
	<div class="meta">
		<div class="date">








  


<time datetime="2012-12-29T00:41:00-08:00" pubdate data-updated="true">Dec 29<span>th</span>, 2012</time></div>
		<div class="tags">


	<a class='category' href='/blog/categories/technology/'>Technology</a>


</div>
		
	</div>
	<h1 class="title"><a href="/blog/2012/12/29/emacs-good-movement-guide/">Emacs Good Movement Guide</a></h1>
	<div class="entry-content">
		<p>Emacs navigation key commands are one of those things every developer should take time to learn. Because once you get to know them, you&#8217;ll be using them throughout your dev lifecycle, including in terminals, editing, and pretty much everywhere if you are using a linux/*nix like macs.</p>

<p><a href="http://www.masteringemacs.org/articles/2011/01/14/effective-editing-movement/">http://www.masteringemacs.org/articles/2011/01/14/effective-editing-movement/</a></p>

<p>For vi/vim users, it may even be a new opportunity for you to take a moment to step outside and experience all the powers and wonders emacs can provide for you. :) Just try.</p>

		
		
	</div>

</article>


    <article class="post">
	<div class="meta">
		<div class="date">








  


<time datetime="2012-12-13T11:34:00-08:00" pubdate data-updated="true">Dec 13<span>th</span>, 2012</time></div>
		<div class="tags">


	<a class='category' href='/blog/categories/technology/'>Technology</a>


</div>
		
	</div>
	<h1 class="title"><a href="/blog/2012/12/13/xenserver-6-auto-start-vms/">Xenserver 6 Auto Start VM&#8217;s</a></h1>
	<div class="entry-content">
		<p>Citrix decided to disable auto-start VM&#8217;s for their free edition startin v6, as I found this out the hard way.</p>

<p>i guess it&#8217;s their strategy of getting you to buy their paid license, which gives you the auto-start from the GUI.</p>

<p>but for the rest of us, here is a quick simple way to do this, you need to manually start the VM&#8217;s upon bootup of the host.</p>

<p>here&#8217;s how:</p>

<p>from the host, edit /etc/rc.local, and at the end of the line, add these two:</p>

<p>sleep 20<br/>
/opt/xensource/bin/xe vm-start uuid=fbd0fdec-9f69-e47f-072a-02ff854fd890</p>

<p>where uuid is that of your VM. you can find the uuid from xencenter on VM&#8217;s general tab.</p>

<p>do this for each VMs you want auto started</p>

		
		
	</div>

</article>


    <article class="post">
	<div class="meta">
		<div class="date">








  


<time datetime="2012-11-06T10:12:00-08:00" pubdate data-updated="true">Nov 6<span>th</span>, 2012</time></div>
		<div class="tags">


	<a class='category' href='/blog/categories/technology/'>Technology</a>


</div>
		
	</div>
	<h1 class="title"><a href="/blog/2012/11/06/strong-iptables-firewall-script-for-cpanel-or-any/">Strong Iptables Firewall Script for Cpanel (or Any Servers)</a></h1>
	<div class="entry-content">
		<pre><code>#!/bin/bash
#####################################################################

# 1) Clear old Rules
iptables -F                                                 # Delete all existing rules

# 2) Default Drop
iptables -P INPUT DROP                                            # Set default chain policies to DROP
iptables -P FORWARD DROP                                        # Set default chain policies to DROP
iptables -P OUTPUT DROP                                            # Set default chain policies to DROP

# 3) Loopback                                                     
iptables -A INPUT -i lo -j ACCEPT                                    # Allow loopback access from INPUT
iptables -A OUTPUT -o lo -j ACCEPT                                    # Allow loopback access from Output

# 4) BLACKLIST IP's
# iptables -A INPUT -s "BLOCK_THIS_IP" -j DROP                                # Block a specific ip-address
# iptables -A INPUT -s "BLOCK_THIS_IP" -j DROP                                # Block a specific ip-address
# iptables -A INPUT -s "BLOCK_THIS_IP" -j DROP                                # Block a specific ip-address
# iptables -A INPUT -s "BLOCK_THIS_IP" -j DROP                                # Block a specific ip-address

# 5) WHITELIST IP's
iptables -A INPUT -s 127.0.0.1/32 -j ACCEPT                                # Allow Anything from localhost     
iptables -A INPUT -s "ALLOW_THIS_IP"/32 -j ACCEPT                                # Allow Anything from KeyServer


# 6) ALLOWED SERVICES
iptables -A OUTPUT -o eth0 -p tcp --sport 25 -m state --state ESTABLISHED -j ACCEPT            # PORT 25   SMTP   - Allow connections to outbound
iptables -A OUTPUT -p udp -o eth0 --dport 53 -j ACCEPT                            # PORT 54   DNS    - Allow connections to outbound 
iptables -A INPUT -p tcp -m tcp --dport 80 -m state --state NEW,ESTABLISHED -j ACCEPT            # PORT 80   httpd  - Allow connections from anywhere
iptables -A INPUT -p tcp --dport 80 -m limit --limit 25/minute --limit-burst 100 -j ACCEPT        # PORT 80   httpd  - Rate Limit from outside
iptables -A INPUT -p tcp -m tcp --dport 443 -m state --state NEW,ESTABLISHED -j ACCEPT            # PORT 443  SSL    - Allow connections from anywhere
iptables -A INPUT -p tcp -m tcp --dport 2082 -m state --state NEW,ESTABLISHED -j ACCEPT            # PORT 2082 cPanel - Allow connections to outbound 
iptables -A INPUT -p tcp -m tcp --dport 2083 -m state --state NEW,ESTABLISHED -j ACCEPT            # PORT 2083 cPanel - Allow connections to outbound 
iptables -A INPUT -p tcp -m tcp --dport 2086 -m state --state NEW,ESTABLISHED -j ACCEPT            # PORT 2086 WHM    - Allow connections to outbound 
iptables -A INPUT -p tcp -m tcp --dport 2087 -m state --state NEW,ESTABLISHED -j ACCEPT            # PORT 2087 WHM    - Allow connections to outbound 

# 7) PING
iptables -A INPUT -p icmp -m icmp --icmp-type address-mask-request -j DROP                # Drop Ping from address-mask-request
iptables -A INPUT -p icmp -m icmp --icmp-type timestamp-request -j DROP                    # Drop Ping from timestamp-request
iptables -A INPUT -p icmp -m icmp -m limit --limit 1/second -j ACCEPT                     # Rate Limit Ping from outside 

# 8) Validate packets
iptables -A INPUT   -m state --state INVALID -j DROP                            # Drop invalid packets 
iptables -A FORWARD -m state --state INVALID -j DROP                            # Drop invalid packets 
iptables -A OUTPUT  -m state --state INVALID -j DROP                            # Drop invalid packets 
iptables -A INPUT -p tcp -m tcp --tcp-flags SYN,FIN SYN,FIN -j DROP                    # Drop TCP - SYN,FIN packets 
iptables -A INPUT -p tcp -m tcp --tcp-flags SYN,RST SYN,RST -j DROP                    # Drop TCP - SYN,RST packets 

# 9) Reject Invalid networks (Spoof)
iptables -A INPUT -s 10.0.0.0/8       -j DROP                                # (Spoofed network)
iptables -a INPUT -s 192.0.0.1/24     -j DROP                                # (Spoofed network)
iptables -A INPUT -s 169.254.0.0/16   -j DROP                                # (Spoofed network)
iptables -A INPUT -s 172.16.0.0/12    -j DROP                                # (Spoofed network)
iptables -A INPUT -s 224.0.0.0/4      -j DROP                                # (Spoofed network)
iptables -A INPUT -d 224.0.0.0/4      -j DROP                                # (Spoofed network)
iptables -A INPUT -s 240.0.0.0/5      -j DROP                                # (Spoofed network)
iptables -A INPUT -d 240.0.0.0/5      -j DROP                                # (Spoofed network)
iptables -A INPUT -s 0.0.0.0/8        -j DROP                                # (Spoofed network)
iptables -A INPUT -d 0.0.0.0/8        -j DROP                                # (Spoofed network)
iptables -A INPUT -d 239.255.255.0/24 -j DROP                                # (Spoofed network)
iptables -A INPUT -d 255.255.255.255  -j DROP                                # (Spoofed network)


# 10) CHAINS

# FTP_BRUTE CHAIN
iptables -A INPUT -p tcp -m multiport --dports 20,21 -m state --state NEW -m recent --set --name FTP_BRUTE
iptables -A INPUT -p tcp -m multiport --dports 20,21 -m state --state NEW -m recent --update --seconds 60 --hitcount 4 --rttl --name FTP_BRUTE -j DROP

# SYNFLOOD CHAIN
iptables -A INPUT -m state --state NEW -p tcp -m tcp --syn -m recent --name SYNFLOOD--set                        
iptables -A INPUT -m state --state NEW -p tcp -m tcp --syn -m recent --name SYNFLOOD --update --seconds 1 --hitcount 60 -j DROP

# Logging CHAIN
iptables -N LOGGING                                                # Create `LOGGING` chain for logging denied packets
iptables -A INPUT -j LOGGING                                            # Create `LOGGING` chain for logging denied packets     
iptables -A LOGGING -m limit --limit 2/min -j LOG --log-prefix "IPTables Packet Dropped: " --log-level 6    # Log denied packets to /var/log/messages
iptables -A LOGGING -j DROP                                            # Drop everything
</code></pre>

		
		
	</div>

</article>


    <article class="post">
	<div class="meta">
		<div class="date">








  


<time datetime="2012-11-01T15:40:49-07:00" pubdate data-updated="true">Nov 1<span>st</span>, 2012</time></div>
		<div class="tags">


	<a class='category' href='/blog/categories/technology/'>Technology</a>


</div>
		
	</div>
	<h1 class="title"><a href="/blog/2012/11/01/install-git-on-centos-5-6/">Install Git on Centos 5/6</a></h1>
	<div class="entry-content">
		<p>you need to disable excludes</p>

<pre><code>yum --disableexcludes=main install git
</code></pre>

		
		
	</div>

</article>


    <article class="post">
	<div class="meta">
		<div class="date">








  


<time datetime="2012-10-24T15:21:48-07:00" pubdate data-updated="true">Oct 24<span>th</span>, 2012</time></div>
		<div class="tags">


	<a class='category' href='/blog/categories/technology/'>Technology</a>


</div>
		
	</div>
	<h1 class="title"><a href="/blog/2012/10/24/emacs-iswitch-mode-makes-switching-between-buffers/">Emacs Iswitch-mode Makes Switching Between Buffers Easier</a></h1>
	<div class="entry-content">
		<p>i somehow came across this <a href="http://emacswiki.org/emacs/IswitchBuffers">[http://emacswiki.org/emacs/IswitchBuffers](http://emacswiki.org/emacs/IswitchBuffers)</a> and i&#8217;m thinking to myself how i didn&#8217;t know about it this whole time.</p>

<p>basically on your ~/.emacs, just put this line of code:<br/>
(iswitchb-mode 1)</p>

<p>and now create multiple buffers, either through multi-window (ctrl+x+2) or (ctrl+f … and type file name)</p>

<p>now just hit ctrl+b, it&#8217;s like mac finder, awesome. </p>

		
		
	</div>

</article>


    <article class="post">
	<div class="meta">
		<div class="date">








  


<time datetime="2012-10-08T16:00:24-07:00" pubdate data-updated="true">Oct 8<span>th</span>, 2012</time></div>
		<div class="tags">


	<a class='category' href='/blog/categories/technology/'>Technology</a>


</div>
		
	</div>
	<h1 class="title"><a href="/blog/2012/10/08/disable-apache-get-requests-logging/">Disable Apache GET Requests Logging</a></h1>
	<div class="entry-content">
		<p>If you are working for PCI compliance, you may have run into situations as to where you need to disable all GET request logging.</p>

<p>This is due to the fact that some merchants might accidentally submit their card processing over GET, in which, the server will be logging all card numbers and other valuable information in clear text.</p>

<p>So to do that:</p>

<p>SetEnvIf Request_Method &#8220;GET&#8221; dontlog<br/>
CustomLog &#8220;/var/log/httpd/site.com.ssl.request.log&#8221; combined env=!dontlog </p>

		
		
	</div>

</article>


    <article class="post">
	<div class="meta">
		<div class="date">








  


<time datetime="2012-10-06T11:34:57-07:00" pubdate data-updated="true">Oct 6<span>th</span>, 2012</time></div>
		<div class="tags">


	<a class='category' href='/blog/categories/technology/'>Technology</a>


</div>
		
	</div>
	<h1 class="title"><a href="/blog/2012/10/06/see-whats-using-up-your-server/">See Whats Using Up Your Server</a></h1>
	<div class="entry-content">
		<h5>see which connections are connected to you sorted by</h5>

<p>netstat -pant | grep :80 | awk &#8216;{ print $5}&#8217; | cut -d: -f1 | sort | uniq -c | sort -n</p>

<h5>see which process are eating up your server</h5>

<p>ps -eo pmem,pcpu,pid,user,rss,vsize,args | { head -1 ; sort -k 1 -r -n ; } | head -10</p>

		
		
	</div>

</article>


    <article class="post">
	<div class="meta">
		<div class="date">








  


<time datetime="2012-10-06T00:05:36-07:00" pubdate data-updated="true">Oct 6<span>th</span>, 2012</time></div>
		<div class="tags">


	<a class='category' href='/blog/categories/technology/'>Technology</a>


</div>
		
	</div>
	<h1 class="title"><a href="/blog/2012/10/06/check-how-many-threads-are-currently-running-in-mysql/">Check How Many Threads Are Currently Running in Mysql</a></h1>
	<div class="entry-content">
		<p>mysqladmin ext -i1 | grep Threads_running</p>

		
		
	</div>

</article>


    <article class="post">
	<div class="meta">
		<div class="date">








  


<time datetime="2012-10-05T12:07:00-07:00" pubdate data-updated="true">Oct 5<span>th</span>, 2012</time></div>
		<div class="tags">


	<a class='category' href='/blog/categories/technology/'>Technology</a>


</div>
		
	</div>
	<h1 class="title"><a href="/blog/2012/10/05/configuring-sysctl-conf-for-high-traffic-sites/">Configuring sysctl.conf for High Traffic Sites (150k+/min)</a></h1>
	<div class="entry-content">
		<p>edit /etc/sysctl.conf</p>

<pre><code> #net.ipv4.netfilter.ip_conntrack_max = 300000 # for centos 5  
 net.netfilter.nf_conntrack_max = 300000 # for centos 6
 net.ipv4.tcp_max_syn_backlog = 10240
 net.core.netdev_max_backlog = 4000
 kernel.panic = 10
 net.ipv4.tcp_slow_start_after_idle=0
 net.ipv4.tcp_tw_reuse = 1
 net.ipv4.ip_local_port_range = 1024 65023
 net.ipv4.tcp_max_syn_backlog = 10240
 net.ipv4.tcp_max_tw_buckets = 400000
 net.ipv4.tcp_max_orphans = 60000
 net.ipv4.tcp_synack_retries = 3
 net.core.somaxconn = 10000
</code></pre>

<h5>also look into considering increasing ulimit</h5>

<p>ulimit -n 30000
ulimit -u 50000</p>

<p>now save then type sysctl -p to reload changes</p>

		
		
	</div>

</article>


    <article class="post">
	<div class="meta">
		<div class="date">








  


<time datetime="2012-10-05T10:33:14-07:00" pubdate data-updated="true">Oct 5<span>th</span>, 2012</time></div>
		<div class="tags">


	<a class='category' href='/blog/categories/technology/'>Technology</a>


</div>
		
	</div>
	<h1 class="title"><a href="/blog/2012/10/05/centos-5-install-from-url-for-xenserver/">Centos 5 Install From Url for XenServer</a></h1>
	<div class="entry-content">
		<p>since i keep forgetting which url i need to put in, here it is:</p>

<p><a href="http://mirror.centos.org/centos-5/5.8/os/x86_64/">[http://mirror.centos.org/centos-5/5.8/os/x86_64/](http://mirror.centos.org/centos-5/5.8/os/x86_64/)</a></p>

		
		
	</div>

</article>


    <article class="post">
	<div class="meta">
		<div class="date">








  


<time datetime="2012-10-01T14:32:05-07:00" pubdate data-updated="true">Oct 1<span>st</span>, 2012</time></div>
		<div class="tags">


	<a class='category' href='/blog/categories/technology/'>Technology</a>


</div>
		
	</div>
	<h1 class="title"><a href="/blog/2012/10/01/percona-xtrabackup-how-to/">Percona Xtrabackup How To</a></h1>
	<div class="entry-content">
		<p>to create a backup:</p>

<p>innobackupex &#8211;user=root &#8211;password=xxx .</p>

<p>this should create a folder in timestamp, i.e; 2012-09-01_11-11-11</p>

<p>innobackupex &#8211;apply-log 2012-09-01_11-11-11</p>

<p>this keeps backup in sync, so make sure to apply this, always.</p>

		
		
	</div>

</article>


    <article class="post">
	<div class="meta">
		<div class="date">








  


<time datetime="2012-09-27T20:45:00-07:00" pubdate data-updated="true">Sep 27<span>th</span>, 2012</time></div>
		<div class="tags">


	<a class='category' href='/blog/categories/technology/'>Technology</a>


</div>
		
	</div>
	<h1 class="title"><a href="/blog/2012/09/27/rotate-outgoing-ip-in-postfix/">Rotate Outgoing Ip in Postfix</a></h1>
	<div class="entry-content">
		<p>Here is a script I wrote for a friend who needed to update his outgoing IP on his postfix server and rotate them once every minute: /root/crons/rotate_postfix_ip.sh and add it to your cronjob to run every minute and you are set!</p>

<pre><code>#!/bin/bash
ips=("64.250.120.128" "64.250.121.241" "64.250.121.242")
length=${#ips[@]}
pos=`cat current.txt`
oldip=${ips[$pos - 1]}
if [ "$length" -eq "$pos" ] ; then
    echo "limit reached"
    pos=1
else
    echo "increment!"
    (( pos++ ))
fi

echo "$pos" &gt; current.txt

newip=${ips[$pos - 1]}
echo "prev: $oldip"
echo "new: $newip"

sed -ie "s/smtp_bind_address=$oldip/smtp_bind_address=$newip/g" /etc/postfix/main.cf &gt; /dev/null
service postfix reload
</code></pre>

		
		
	</div>

</article>


    <article class="post">
	<div class="meta">
		<div class="date">








  


<time datetime="2012-09-14T15:06:11-07:00" pubdate data-updated="true">Sep 14<span>th</span>, 2012</time></div>
		<div class="tags">


	<a class='category' href='/blog/categories/technology/'>Technology</a>


</div>
		
	</div>
	<h1 class="title"><a href="/blog/2012/09/14/tcpdump-get-ip-of-all-outgoing-https-connections/">Tcpdump Get IP of All Outgoing HTTPS Connections</a></h1>
	<div class="entry-content">
		<p>As you can see, tcpdump is very english friendly and you can structure it as however you like:</p>

<p>tcpdump -nn -vv dst not 10.102.136.11 and port not 22 and dst not 10.102.136.100 and dst not 10.102.136.109 and dst not 10.102.136.95 and not udp and not arp</p>

		
		
	</div>

</article>


    <article class="post">
	<div class="meta">
		<div class="date">








  


<time datetime="2012-09-13T16:24:49-07:00" pubdate data-updated="true">Sep 13<span>th</span>, 2012</time></div>
		<div class="tags">


	<a class='category' href='/blog/categories/technology/'>Technology</a>


</div>
		
	</div>
	<h1 class="title"><a href="/blog/2012/09/13/dnsmasq-as-a-centralized-hosts-file/">Dnsmasq as a Centralized Hosts File</a></h1>
	<div class="entry-content">
		<p>if you are like me and like things where you can get setup in a quick pinch, you&#8217;ll like dnsmasq.</p>

<p>have you ever had a time where you had multiple servers and have wondered why we can&#8217;t just easily have a central hosts file so they are all synchronized?</p>

<p>well look no further. dnsmasq, is that, and more.</p>

<p>install dnsmasq on centos 5.8 is as easy as: yum install dnsmasq -y</p>

<p>that&#8217;s it, you just now need to start it up: service dnsmasq start, and point your other server&#8217;s /etc/resolv.conf to your dnsmasq server.</p>

<h1>note if you are on openvz, make sure you set user=root in /etc/dnsmasq.conf, otherwise it won&#8217;t let you start the service.</h1>

		
		
	</div>

</article>


    <article class="post">
	<div class="meta">
		<div class="date">








  


<time datetime="2012-09-13T13:24:31-07:00" pubdate data-updated="true">Sep 13<span>th</span>, 2012</time></div>
		<div class="tags">


	<a class='category' href='/blog/categories/technology/'>Technology</a>


</div>
		
	</div>
	<h1 class="title"><a href="/blog/2012/09/13/change-master-host-on-mysql/">Change Master Host on Mysql</a></h1>
	<div class="entry-content">
		<p>CHANGE MASTER TO MASTER_HOST=&#8217;db0.local&#8217;, MASTER_USER=&#8217;xxx&#8217;, MASTER_PASSWORD=&#8217;xxx&#8217;, MASTER_LOG_FILE=&#8217;mysql-bin.000003&#8217;, MASTER_LOG_POS=628;</p>

		
		
	</div>

</article>


    <article class="post">
	<div class="meta">
		<div class="date">








  


<time datetime="2012-09-11T17:09:27-07:00" pubdate data-updated="true">Sep 11<span>th</span>, 2012</time></div>
		<div class="tags">


	<a class='category' href='/blog/categories/technology/'>Technology</a>


</div>
		
	</div>
	<h1 class="title"><a href="/blog/2012/09/11/a-perl-script-to-check-for-system-configuration/">A Perl Script to Check for System Configuration</a></h1>
	<div class="entry-content">
		<pre><code>#!/usr/bin/perl
#  Version 0.0.1.F alpha
#  To use locally.
#   example:    "./pci_check.pl"
#
#  Remotely redirect to ssh.  
#   example:    "ssh username@servername perl &lt; pci_check.pl"
#
#  Looping through multiple servers. 
#   example:    "for server in servername1 servername2 servernameetc; do ssh username@$server perl &lt; pci_check.pl; done"
#
#  Redirect output to local file.
#   example:    "ssh username@servername perl &lt; pci_check.pl &gt;&gt; output.txt"
#
#  Redirecting output to a local file while looping through multiple servers.
#   example:    "for server in servername1 servername2 servernameetc; do ssh username@$server perl &lt; pci_check.pl &gt;&gt; output.txt; done"
#
#  Looping through multiple servers specified from a list.
#   example:    "for server in `cat serverlist.txt` ; do ssh username@$server perl &lt; pci_check.pl; done" 
#

use strict;
my $internet_connectivity_url = "http://www.google.com";

my $which_cmd = "which";
my $etc_passwd_file = "/etc/passwd";
my $etc_login_defs_file = "/etc/login.defs";
my $etc_lsb_release_file = "/etc/lsb-release";
my $etc_redhat_release_file = "/etc/redhat-release";
my $etc_gentoo_release_file = "/etc/gentoo-release";
my $etc_ntp_conf_file = "/etc/ntp.conf";
my $etc_exports_file = "/etc/exports";
my $etc_fstab_file = "/etc/fstab";
my $etc_ssh_sshd_conf_file = "/etc/ssh/sshd_config";
my $var_log_clamav_freshclam_log = "/var/log/clamav/freshclam.log";
my $my_id = `id -u`;
my $sysctl_cmd = "/sbin/sysctl";
my $passwd_cmd = `$which_cmd passwd`;
  chomp $passwd_cmd;
my $curl_cmd = `$which_cmd curl`;
  chomp $curl_cmd;
my $crontab_cmd = `$which_cmd crontab`;
  chomp $crontab_cmd;
my $ifconfig_cmd= `$which_cmd ifconfig`;
  chomp $ifconfig_cmd;



my $hostname = `/bin/hostname`;
my @ps_cmd = `/bin/ps -eo %c h`;
my @ifconfig = `$ifconfig_cmd`;
my @netstat = `/bin/netstat -nlp`;
my @pam_d_contents = `/bin/cat /etc/pam.d/*  2&gt; /dev/null`;
if ($my_id == 0)
  {
    my @crontab = `$crontab_cmd -l`;
  }


my @installed_packages;
my $os_distro;
my $ipv6_status;

my @sysctl_oids = 
  qw( 
    net.ipv4.conf.all.forwarding
    net.ipv4.conf.default.forwarding
    net.ipv4.ip_forward
    net.ipv4.conf.default.accept_source_route
    net.ipv4.conf.all.accept_source_route
  );

my @cron_directories =
  qw(
    /etc/cron.hourly
    /etc/cron.daily
    /etc/cron.weekly
    /etc/cron.montly
    );

my @log_directories =
  qw(
    /var/log
    /var/log/httpd
    );

my @login_defs = open_file($etc_login_defs_file);
my @etc_lsb_release = open_file($etc_lsb_release_file);
my @etc_redhat_release = open_file($etc_redhat_release_file);
my @etc_gentoo_release = open_file($etc_gentoo_release_file);
my @etc_ntp_conf = open_file($etc_ntp_conf_file);
my @etc_exports = open_file($etc_exports_file);
my @etc_fstab = open_file($etc_fstab_file);
my @etc_ssh_sshd_conf = open_file($etc_ssh_sshd_conf_file);
my @etc_passwd = open_file($etc_passwd_file);
my @clamav_freshclam = open_file($var_log_clamav_freshclam_log);


print "Hostname:nt$hostname";

#print whether internet connectivity is detected or not
if ( length($curl_cmd) != 0 )
  {
    if ( `$curl_cmd --silent -m 5 $internet_connectivity_url` )
      {
        print "tINTERNET CONNECTIVITY DETECTEDn";
      }
    else
      {
        print "tNO INTERNET CONNECTIVITYn";
      }
  }

print "OS Version:n";
foreach (@etc_lsb_release)
  {
    if (/DISTRIB_DESCRIPTION="(.*)"/)
      {
        print "t$1n";
    $os_distro = $1;
      }
  }

foreach (@etc_redhat_release)
  {
    if (/(.*)/)
      {
        print "t$1n";
        $os_distro = $1;
      }
  }
foreach (@etc_gentoo_release)
  {
    if (/(.*)/)
      {
         print "t$1n";
         $os_distro = $1;
      }
  }


#Loop through ifconfig for IP Addresses
print "IP Addresses:n";
foreach (@ifconfig)
  {
    if (/inet (?:addr:)?([d.]+)/)
      {
        print "t$1n";
      }
  }  



#Loop through ifconfig for IPv6
foreach (@ifconfig)
  {
    if (/inet6/)
      {
        $ipv6_status = 1;
        last;
      }
  } 

if ($ipv6_status)
  {
    print "IPv6 is Enabledn";
  }
else
  {
    print "IPv6 is Disabledn";
  }


#services
print "Listening Services:n";
foreach (@netstat)
  {
    if (/(tcp|udp).* ([d.d.d.d]+:d+)/)
      {
        print "t$1 $2n";
      }
  }



#Sysctl Values
print "IP sysctl:n";
foreach (@sysctl_oids)
  {
    print "t" . read_sysctl($_);
  }

#Enumerate System Users
print "Users:n";
foreach (@etc_passwd)
  {
    my($login, $passwd, $uid, $gid,$gcos, $home, $shell) = split(/:/);
    print "t$logint$homet$shell";
      if ( $my_id == 0 )
        {
          print "t".`$passwd_cmd -S $login`;
        }
  }


#NTP server configuration
print "NTP Servers:n";
foreach (@etc_ntp_conf)
  {
    if (m/^(server.*)/)
      {
        print "t$1n";
      }
  }

#List filesystem exports
print "Filesystem NFS Exports:n";
foreach (@etc_exports)
  {
    if (!(m/^#/))
      {
    print "t$_";
      }
  }


#etc fstab contents
print "fstab mounts:n";
foreach (@etc_fstab)
  {
    if (!(m/^#/))
      {
        print "t$_";
      }
  }

#etc sshd config contents
if ($my_id == 0)
  {
  print "sshd_conf:n";
  foreach (@etc_ssh_sshd_conf)
    {
      if (!(m/^#/) &amp;&amp; !(m/^$/))
        {
          print "t$_";
        }
    }
  }


#Determine OS and find installed packages
if ($os_distro =~ m/ubuntu/i)
  {
    my @installed_packages_tmp = `/usr/bin/dpkg -l`;
    foreach (@installed_packages_tmp)
      {
        my @line =  split(/s+/, $_);
        push @installed_packages, "$line[1]t$line[2]n";
      }
  }

if ($os_distro =~ m/debian/i)
  {
    my @installed_packages_tmp = `/usr/bin/dpkg -l`;
    foreach (@installed_packages_tmp)
      {
        my @line =  split(/s+/, $_);
        push @installed_packages, "$line[1]t$line[2]n";
      }
  }

if ($os_distro =~ m/gentoo/i)
  {
    @installed_packages = `ls -d /var/db/pkg/*/*`;
  }

if ($os_distro =~ m/centos/i)
  {
    @installed_packages = `rpm -qa`;
  }

if ($os_distro =~ m/red hat/i)
  {
    @installed_packages = `rpm -qa`;
  }


print "Installed packages:n";
foreach (@installed_packages)
  {
    if (m/(.*(ssh|ntp|httpd|apache|named|bind|avg|clam|portmap|sophos|sys|ssl|cups|sec|tripwire).*)/i)
    {
       print "t$1n";
    } 
  }


if (-e $var_log_clamav_freshclam_log)
    {
      print "ClamAV Updates:n";
      foreach (@clamav_freshclam[-30,-1])
        {
          print "t$_";
        }
    }

print "File contents: login.defsn";
foreach (@login_defs)
  {
    if (m/(^(MD5_CRYPT_ENAB|ENCRYPT_METHOD|LOGIN_RETRIES|LOGIN_TIMEOUT|LOG_OK_LOGINS|SYSLOG_SU_ENAB|PASS_MAX_DAYS).*)/i){print "t$1n";}
  }


print "Pam.d config:n";
foreach (@pam_d_contents)
  {
    if ((!(m/^#/) &amp;&amp; ((m/(.*pam_unix.*)/i) || (m/(.*pam_tally.*)/i) || (m/(.*pam_crack.*)/i) || (m/(.*minlen.*)/i) || (m/(.*retry.*)/i)) ) )
      {
        print "t$1n";
      }
  }

print "Cron Jobs:n";
foreach my $file (@cron_directories)
  {
    foreach (&lt;$file/*&gt;)
      {
        print "t $_n";
      }
  }

print "Log Files:n";
foreach my $file (@log_directories)
  {
    foreach (&lt;$file/*&gt;)
      {
    if (!(m/.[0-9]/))
          {
            print "t $_n";
          }
      }
  }


#Sort unique processes 
print "System Processes:n";
my %seen;
foreach ( sort( grep{ ! $seen{$_}++ } @ps_cmd))
  {
    print "t$_";
  }




#Argument filename, Returns array
sub open_file
  {
    my $file_name = $_[0];
    open FILE, ")
      {
        push(@file_contents, $_);
      }
    close FILE;
    return @file_contents;
  }

#Read specific sysctl
sub read_sysctl
  {
    my $search_oid=$_[0];
    open SYSCTL, "$sysctl_cmd $search_oid |" || die "Can't run sysctl: $!n";
    my $output;
    while ()
      {
        $output = $_;
      }
    close SYSCTL;
    return $output;
  }
</code></pre>

		
		
	</div>

</article>


    <article class="post">
	<div class="meta">
		<div class="date">








  


<time datetime="2012-09-05T15:43:11-07:00" pubdate data-updated="true">Sep 5<span>th</span>, 2012</time></div>
		<div class="tags">


	<a class='category' href='/blog/categories/technology/'>Technology</a>


</div>
		
	</div>
	<h1 class="title"><a href="/blog/2012/09/05/encrypt-decrypt-tar-backups/">Encrypt / Decrypt Tar Backups</a></h1>
	<div class="entry-content">
		<h1><strong> tar -zcf todays_backup.tar.gz todays_backup</strong></h1>

<p>This <a href="http://www.simplehelp.net/2009/02/19/adding-encryption-to-protect-your-backups-on-linux/#">command</a> will compress the directory <strong>todays_backup</strong> into the compressed file<strong>todays_backup.tar.gz</strong>. To decompress it use the following command:</p>

<h1><strong> tar -zxf todays_backup.tar.gz</strong></h1>

<p>Now to the fun part. Let’s look at how we can add a basic level of <a href="http://www.simplehelp.net/2009/02/19/adding-encryption-to-protect-your-backups-on-linux/#">encryption</a> to the process we used above. To compress the directory <strong>todays_backup</strong> with protection do the following:</p>

<h1> <strong>tar -zcf – todays_backup|openssl des3 -salt -k yourpassword | dd of=todays_backup.des3</strong></h1>

<p>Replace <strong>yourpassword</strong> with a password of your own. Keep the password to yourself, and keep it carefully. The above command will generate a file called <strong>todays_backup.des3</strong>. This file can only be decompressed using this password.</p>

<p>To extract your protected <a href="http://www.simplehelp.net/2009/02/19/adding-encryption-to-protect-your-backups-on-linux/#">archive file</a> <strong>todays_backup.des3</strong> use the following command:</p>

<h1> <strong>dd if= todays_backup.des3 |openssl des3 -d -k yourpassword |tar zxf -</strong></h1>

<p>Make note of the trailing <strong>-</strong> at the end. It is not a typo, but a requirement for this command to work. Replace <strong>yourpassword</strong> with the password you used while encrypting the file. Executing the above command will extract the <a href="http://www.simplehelp.net/2009/02/19/adding-encryption-to-protect-your-backups-on-linux/#">compressed file</a> <strong>todays_backup.des3</strong> into a directory<strong>todays_backup</strong>. Use this encryption with care. As I said earlier, the only way you can retrieve your data once secured is by using the password, so do not lose this password under any circumstances.</p>

		
		
	</div>

</article>


    <article class="post">
	<div class="meta">
		<div class="date">








  


<time datetime="2012-08-31T14:01:57-07:00" pubdate data-updated="true">Aug 31<span>st</span>, 2012</time></div>
		<div class="tags">


	<a class='category' href='/blog/categories/technology/'>Technology</a>


</div>
		
	</div>
	<h1 class="title"><a href="/blog/2012/08/31/tcpdump-capture-packets-while-connected-on-ssh/">Tcpdump Capture Packets While Connected on SSH</a></h1>
	<div class="entry-content">
		<p>tcpdump by default will listen and output everything, including your current SSH session, which means you&#8217;ll get a lot of junk!</p>

<p>so do this to ignore all ssh connections to filter them out</p>

<p>tcpdump -i any -s 0 not port ssh</p>

		
		
	</div>

</article>

<nav id="pagenavi">
    
    
        <a href="/blog/page/2/" class="next">Next</a>
    
    <div class="center"><a href="/blog/archives">Blog Archives</a></div>
</nav></div>
			</div>
			<footer id="footer" class="inner"><p>
  Copyright &copy; 2013 - jaequery
  <!-- - <span class="credit">Powered by Jesus</span>-->
</p>

</footer>
			<script src="/javascripts/slash.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->


<script type="text/javascript">
      var disqus_shortname = 'jaequerycom';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



	<script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-38367647-1']);
		_gaq.push(['_trackPageview']);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	</script>




		</div>
	</div>
</body>
</html>
